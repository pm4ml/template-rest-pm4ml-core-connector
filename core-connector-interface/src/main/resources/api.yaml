openapi: 3.0.1
info:
  title: Payment Manager for Mojaloop API
  description: >
    Specification for the Payment Manager for Mojaloop API
    This API can be used by DFSP backends to simplify the process of sending and receiving funds within a Mojaloop scheme.
    **Note on terminology:** The term "Switch" is equal to the term "Hub", and the term "FSP" is equal to the term "DFSP".
  license:
    name: Apache License Version 2.0, January 2004
    url: http://www.apache.org/licenses/
  version: 1.0.0


paths:

  /health:
    get:
      description: >
        The HTTP request `GET /health` is used to check if application is up and running.
      operationId: getHealth
      tags:
        - Health
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: string

  /loanDisbursementToWallet:
    post:
      summary: mifos loan disbursment
      description: >
        mifos loan disbursment.
      operationId: postOriginalDisbursement
      tags:
        - loandisbursement
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/loanDisbursementToMobileWallet'
      responses:
        200:
          $ref: '#/components/responses/transferSuccess'
        500:
          $ref: '#/components/responses/transferServerError'
        504:
          $ref: '#/components/responses/transferTimeout'

  #Outbound API (Payer DFSP → Payment Manager → Mojaloop Switch)
  /sendmoney:
    post:
      summary: Sends money from one account to another
      description: >
        The HTTP request `POST /sendmoney` is used by the Payer DFSP to request the movement of funds from the Payer DFSP to the Payee DFSP.
        The underlying Mojaloop API has three stages for money transfer:
          1. Party lookup. This facilitates a check by the sending party that the destination party is correct before proceeding with a money movement.
          2. Quotation. This facilitates the exchange of fee information and the construction of a cryptographic "contract" between the Payee and Payer DFSPs before funds are transferred.
          3. Transfer. The enactment of the previously agreed "contract".
        This method has several modes of operation.
        - If the configuration variables `AUTO_ACCEPT_PARTY` is set to `"false"`, this method will terminate when the Payee party has been resolved and return the payee party details.
          If the payee wishes to proceed with the transfer, then a subsequent `PUT /sendmoney/{transferId}` request (accepting the Payee party) is required to continue the operation.
          The Payment Manager will then proceed with quotation stage.
        - If the configuration variable `AUTO_ACCEPT_QUOTES` is set to `"false"`, this method will terminate and return the quotation when it has been received from the Payee DFSP.
          If the Payee wishes to proceed with the transfer, then a subsequent `PUT /sendmoney/{transferId}` request (accepting the quote) is required to continue the operation.
          The Payment Manager will then proceed with the transfer state.
        If the configuration variables `AUTO_ACCEPT_PARTY` and `AUTO_ACCEPT_QUOTES` are both set to `"true"`, this method will block until all three transfer stages are complete.
        Upon completion, it will return the entire set of transfer details received during the operation.
        Combinations of settings for `AUTO_ACCEPT...` configuration variables allow the Payment Manager user to decide which mode of operation best suits their use cases. i.e., the Payment Manager can be configured to "break" the three-stage transfer at these points in order to execute backend logic such as party verification, quoted fees assessments, etc.
      operationId: postSendMoney
      tags:
        - Sendmoney
      requestBody:
        description: Transfer request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/transferRequest'
        required: true
      responses:
        200:
          $ref: '#/components/responses/transferSuccess'
        400:
          $ref: '#/components/responses/transferBadRequest'
        500:
          $ref: '#/components/responses/transferServerError'
        504:
          $ref: '#/components/responses/transferTimeout'

  /sendmoney/{transferId}:
    put:
      summary: Continues a transfer that has paused at the party lookup and/or quote stage in order to accept or reject payee party and/or quote
      description: >
        The HTTP request `PUT /sendmoney/{transferId}` is used by the Payer DFSP to continue a transfer initiated via the `POST /sendmoney` method that has halted after party lookup and/or quotation stage.
        The request body should contain either the "acceptParty" or "acceptQuote" property set to `true` as required to continue the transfer.
        See the description of the `POST /sendmoney` HTTP method for more information on modes of transfer.
      operationId: putSendMoneyByTransferId
      tags:
        - Sendmoney
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/transferContinuationAccept'
      parameters:
        - $ref: '#/components/parameters/transferId'
      responses:
        200:
          $ref: '#/components/responses/transferSuccess'
        500:
          $ref: '#/components/responses/transferServerError'
        504:
          $ref: '#/components/responses/transferTimeout'

  #Inbound API (Mojaloop Switch → Payment Manager → Payee DFSP)
  /parties/{idType}/{idValue}:
    get:
      summary: Requests information relating to a transfer party identified by the specified identifier type and value
      description: The HTTP request `GET /parties/{idType}/{idValue}` is sent to the Payee DFSP, and it is used to look up information regarding the requested transfer party, identified by `{idType}` and `{idValue}`.
      operationId: getParties
      tags:
        - Parties
      parameters:
        - $ref: '#/components/parameters/idType'
        - $ref: '#/components/parameters/idValue'
      responses:
        200:
          description: Response containing details of the requested party
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/transferPartyInbound'
        400:
          $ref: '#/components/responses/400'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'

  /quoterequests:
    post:
      summary: Requests a quote for the specified transfer
      description: The HTTP request `POST /quoterequests` is sent to the Payee DFSP, and it is used to request the creation of a quote for the provided financial transaction.
      operationId: postQuoterequests
      tags:
        - Quotes
      requestBody:
        description: Request for a transfer quotation
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/quoteRequest'
      responses:
        200:
          description: A response to the transfer quotation request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/quoteResponse'
        400:
          $ref: '#/components/responses/400'
        500:
          $ref: '#/components/responses/500'

  /transfers:
    post:
      summary: Transfers funds from an external account to an internal account
      description: The HTTP request `POST /transfers` is sent to the Payee DFSP, and it is used to request the creation of a transfer for the transfer party.
      operationId: postTransfers
      tags:
        - Transfers
      requestBody:
        description: An incoming transfer request
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/transferRequestInbound'
      responses:
        200:
          description: The transfer was accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/transferResponseInbound'
        400:
          $ref: '#/components/responses/400'
        500:
          $ref: '#/components/responses/500'
  /transfers/{transferId}:
    put:
      summary: Provides a notification about the success/failure of a specific transfer
      description: The HTTP request `PUT /transfers/{transferId}` is sent to the Payee DFSP, and it is used to notify the Payee DFSP about the final state of a transfer, to indicate whether the transfer has been committed or aborted in the Switch.
      operationId: putTransfers
      tags:
        - Transfers
      parameters:
        - $ref: '#/components/parameters/transferId'
      requestBody:
        description: An incoming notification for a fulfilled transfer
        content:
          application/json:
            schema:
              #$ref: '#/components/schemas/putTransferRequestInbound'
              $ref: '#/components/schemas/fulfilNotification'
      responses:
        200:
          description: The notification was accepted
        500:
          $ref: '#/components/responses/500'

components:
  schemas:

    loanDisbursementToMobileWallet:
      title: Loan disbursement to wallet
      type: object
      description: Loan disbursement to wallet information construct.
      properties:
        officeId:
          type: string
        clientId:
          type: string
        resourceId:
          type: string
        loanId:
          type: string
        changes:
          $ref: '#/components/schemas/changes'
      required:
        - loanId
        - changes

    changes:
      title: Changes on loan disbursement
      type: object
      properties:
        accountNumber:
          type: string
        bankNumber:
          type: string
        status:
          type: object
        locale:
          type: string
        dateFormat:
          type: string
        actualDisbursementDate:
          type: string
      required:
        - accountNumber
        - bankNumber

    inBody:
      type: object
    amountType:
      type: string
      enum:
        - SEND
        - RECEIVE
      description: SEND for send amount, RECEIVE for receive amount.

    currency:
      maxLength: 3
      minLength: 3
      type: string
      enum:
        - AED
        - AFN
        - ALL
        - AMD
        - ANG
        - AOA
        - ARS
        - AUD
        - AWG
        - AZN
        - BAM
        - BBD
        - BDT
        - BGN
        - BHD
        - BIF
        - BMD
        - BND
        - BOB
        - BRL
        - BSD
        - BTN
        - BWP
        - BYN
        - BZD
        - CAD
        - CDF
        - CHF
        - CLP
        - CNY
        - COP
        - CRC
        - CUC
        - CUP
        - CVE
        - CZK
        - DJF
        - DKK
        - DOP
        - DZD
        - EGP
        - ERN
        - ETB
        - EUR
        - FJD
        - FKP
        - GBP
        - GEL
        - GGP
        - GHS
        - GIP
        - GMD
        - GNF
        - GTQ
        - GYD
        - HKD
        - HNL
        - HRK
        - HTG
        - HUF
        - IDR
        - ILS
        - IMP
        - INR
        - IQD
        - IRR
        - ISK
        - JEP
        - JMD
        - JOD
        - JPY
        - KES
        - KGS
        - KHR
        - KMF
        - KPW
        - KRW
        - KWD
        - KYD
        - KZT
        - LAK
        - LBP
        - LKR
        - LRD
        - LSL
        - LYD
        - MAD
        - MDL
        - MGA
        - MKD
        - MMK
        - MNT
        - MOP
        - MRO
        - MUR
        - MVR
        - MWK
        - MXN
        - MYR
        - MZN
        - NAD
        - NGN
        - NIO
        - NOK
        - NPR
        - NZD
        - OMR
        - PAB
        - PEN
        - PGK
        - PHP
        - PKR
        - PLN
        - PYG
        - QAR
        - RON
        - RSD
        - RUB
        - RWF
        - SAR
        - SBD
        - SCR
        - SDG
        - SEK
        - SGD
        - SHP
        - SLL
        - SOS
        - SPL
        - SRD
        - STD
        - SVC
        - SYP
        - SZL
        - THB
        - TJS
        - TMT
        - TND
        - TOP
        - TRY
        - TTD
        - TVD
        - TWD
        - TZS
        - UAH
        - UGX
        - USD
        - UYU
        - UZS
        - VEF
        - VND
        - VUV
        - WST
        - XAF
        - XCD
        - XDR
        - XOF
        - XPF
        - XTS
        - XXX
        - YER
        - ZAR
        - ZMW
        - ZWD

    dateOfBirth:
      type: string
      pattern: ^(?:[1-9]\d{3}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1\d|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[1-9]\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-02-29)$
      description: Date of birth in the form YYYY-MM-DD.

    errorCode:
      title: ErrorCode
      type: string
      pattern: '^[1-9]\d{3}$'
      description: >
        The API data type errorCode is a JSON String of four characters,
        consisting of digits only. Negative numbers are not allowed. A leading
        zero is not allowed. Each error code in the API is a four-digit number,
        for example, 1234, where the first number (1 in the example) represents
        the high-level error category, the second number (2 in the example)
        represents the low-level error category, and the last two numbers (34 in
        the example) represents the specific error.



    errorDescription:
      title: ErrorDescription
      type: string
      minLength: 1
      maxLength: 128
      description: Error description string.

    errorInformation:
      title: ErrorInformation
      type: object
      description: A Mojaloop API error information construct.
      properties:
        errorCode:
          $ref: '#/components/schemas/errorCode'
          description: Specific error number.
        errorDescription:
          $ref: '#/components/schemas/errorDescription'
          description: Error description string.
        extensionList:
          $ref: '#/components/schemas/extensionListComplex'
          description: 'Optional list of extensions, specific to deployment.'
      required:
        - errorCode
        - errorDescription

    errorResponse:
      type: object
      properties:
        statusCode:
          type: string
          description: Error code as string.
        message:
          type: string
          description: Error message text.

    errorTransferResponse:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - type: object
          required:
            - transferState
          properties:
            transferState:
              $ref: '#/components/schemas/transferResponse'

    extensionItem:
      type: object
      properties:
        key:
          type: string
          minLength: 1
          maxLength: 32
        value:
          type: string
          minLength: 1
          maxLength: 128

    extensionList:
      type: array
      items:
        $ref: '#/components/schemas/extensionItem'
      minItems: 0
      maxItems: 16

    extensionListComplex:
      type: object
      description: Data model for the complex type ExtensionList
      properties:
        extension:
          type: array
          items:
            $ref: '#/components/schemas/extensionItem'
          minItems: 1
          maxItems: 16
          description: Number of Extension elements
      required:
        - extension

    fulfilNotification:
      title: TransfersIDPatchResponse
      type: object
      description: PUT /transfers/{transferId} object
      properties:
        transferId:
          $ref: '#/components/schemas/transferId'
        direction:
          type: string
          enum:
            - INBOUND
        quoteRequest:
          type: object
          properties:
            headers:
              type: object
            body:
              type: object
        quoteResponse:
          type: object
          properties:
            headers:
              type: object
            body:
              type: object
        prepare:
          type: object
          properties:
            headers:
              type: object
            body:
              type: object
        fulfil:
          type: object
          properties:
            headers:
              type: object
            body:
              type: object
        quote:
          type: object
          properties:
            request:
              type: object
            internalRequest:
              type: object
            response:
              type: object
            mojaloopResponse:
              type: object
            fulfilment:
              type: string
        currentState:
          $ref: '#/components/schemas/transferStatus'
        lastError:
          $ref: '#/components/schemas/transferError'
        initiatedTimestamp:
          $ref: '#/components/schemas/timestamp'
        finalNotification:
          type: object
          properties:
            completedTimestamp:
              $ref: '#/components/schemas/timestamp'
              description: Time and date when the transaction was completed.
              example: "2020-05-19T08:38:08.699-04:00"
            transferState:
              $ref: '#/components/schemas/transferState'
              description: State of the transfer.
              example: COMMITTED
            extensionList:
              $ref: '#/components/schemas/extensionList'
              description: Optional extension, specific to deployment.
          required:
            - completedTimestamp
            - transferState

    geoCode:
      type: object
      description: >
        Data model for the Mojaloop API complex type GeoCode. Indicates a geographic location
      properties:
        latitude:
          $ref: '#/components/schemas/latitude'
          description: Latitude of the Party.
        longitude:
          $ref: '#/components/schemas/longitude'
          description: Longitude of the Party.
      required:
        - latitude
        - longitude

    idType:
      type: string
      enum:
        - MSISDN
        - ACCOUNT_ID
      description: Below are the allowed values for the enumeration.

        - MSISDN -  An MSISDN (Mobile Station International Subscriber Directory Number, that is, the phone number) is used as reference to a participant. The MSISDN identifier should be in international format according to the [ITU-T E.164 standard](https://www.itu.int/rec/T-REC-E.164/en). Optionally, the MSISDN may be prefixed by a single plus sign, indicating the international prefix.

        - ACCOUNT_ID - A bank account number or FSP account ID should be used as reference to a participant. The ACCOUNT_ID identifier can be in any format, as formats can greatly differ depending on country and FSP.

    idValue:
      type: string
      minLength: 1
      maxLength: 128
      description: Identifier of the party.

    ilpCondition:
      type: string
      pattern: '^[A-Za-z0-9-_]{43}$'
      maxLength: 48
      description: Condition that must be attached to the transfer by the Payer.

    ilpFulfilment:
      type: string
      pattern: '^[A-Za-z0-9-_]{43}$'
      maxLength: 48
      description: Fulfilment that must be attached to the transfer by the Payee.

    ilpPacket:
      type: string
      pattern: '^[A-Za-z0-9-_]+[=]{0,2}$'
      minLength: 1
      maxLength: 32768
      description: Information for recipient (transport layer information).

    initiator:
      type: string
      enum:
        - PAYER
        - PAYEE
      description: Specifies if the initiator of the transfer is the Payer or Payee.

    initiatorType:
      type: string
      enum:
        - CONSUMER
        - AGENT
        - BUSINESS
        - DEVICE
      description: Specifies the type of the transaction initiator.

    latitude:
      type: string
      pattern: >-
        ^(\+|-)?(?:90(?:(?:\.0{1,6})?)|(?:[0-9]|[1-8][0-9])(?:(?:\.[0-9]{1,6})?))$
      description: >
        The API data type Latitude is a JSON String in a lexical format that is
        restricted by a regular expression for interoperability reasons.


    longitude:
      type: string
      pattern: >-
        ^(\+|-)?(?:180(?:(?:\.0{1,6})?)|(?:[0-9]|[1-9][0-9]|1[0-7][0-9])(?:(?:\.[0-9]{1,6})?))$
      description: >-
        The API data type Longitude is a JSON String in a lexical format that is
        restricted by a regular expression for interoperability reasons.


    mojaloopError:
      type: object
      properties:
        errorInformation:
          $ref: '#/components/schemas/errorInformation'

    mojaloopIdentifier:
      pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      type: string
      description: A Mojaloop API identifier (UUID).

    mojaloopMoney:
      title: Money
      type: object
      description: Data model for the Mojaloop API complex type Money.
      properties:
        currency:
          $ref: '#/components/schemas/currency'
          description: Currency of the amount.
        amount:
          $ref: '#/components/schemas/money'
          description: Amount of Money.
      required:
        - currency
        - amount

    mojaloopTransferState:
      type: string
      enum:
        - RECEIVED
        - RESERVED
        - COMMITTED
        - ABORTED
      description: >
        Below are the allowed values for the enumeration
        - RECEIVED The Switch has received the transfer.
        - RESERVED The Switch has reserved the transfer.
        - COMMITTED The Switch has successfully performed the transfer.
        - ABORTED The Switch has aborted the transfer due a rejection or failure to perform the transfer.


    money:
      pattern: ^([0]|([1-9][0-9]{0,17}))([.][0-9]{0,3}[1-9])?$
      type: string

    payerType:
      type: string
      enum:
        - CONSUMER
        - AGENT
        - BUSINESS
        - DEVICE

    quote:
      type: object
      description: Mojaloop API response to a quote request
      properties:
        transferAmount:
          $ref: '#/components/schemas/mojaloopMoney'
          description: >
            The amount of Money that the Payer FSP should transfer to the Payee
            FSP.
        payeeReceiveAmount:
          $ref: '#/components/schemas/mojaloopMoney'
          description: >
            The amount of Money that the Payee should receive in the end-to-end
            transaction. Optional as the Payee FSP might not want to disclose
            any optional Payee fees.
        payeeFspFee:
          $ref: '#/components/schemas/mojaloopMoney'
          description: Payee FSP’s part of the transaction fee.
        payeeFspCommission:
          $ref: '#/components/schemas/mojaloopMoney'
          description: Transaction commission from the Payee FSP.
        expiration:
          $ref: '#/components/schemas/timestamp'
          description: >
            Date and time until when the quotation is valid and can be honored
            when used in the subsequent transaction.
        geoCode:
          $ref: '#/components/schemas/geoCode'
          description: Longitude and Latitude of the Payee. Can be used to detect fraud.
        ilpPacket:
          $ref: '#/components/schemas/ilpPacket'
          description: The ILP Packet that must be attached to the transfer by the Payer.
        condition:
          $ref: '#/components/schemas/ilpCondition'
          description: The condition that must be attached to the transfer by the Payer.
        extensionList:
          $ref: '#/components/schemas/extensionListComplex'
          description: 'Optional extension, specific to deployment.'
      required:
        - transferAmount
        - expiration
        - ilpPacket
        - condition

    quoteId:
      pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      type: string
      description: A Mojaloop API quote identifier (UUID).

    quoteRequest:
      type: object
      description: A request for a quote for transfer from the DFSP backend.
      required:
        - quoteId
        - transactionId
        - to
        - from
        - amountType
        - amount
        - currency
        - transactionType
        - initiator
        - initiatorType
      properties:
        quoteId:
          $ref: '#/components/schemas/quoteId'
        transactionId:
          $ref: '#/components/schemas/transactionId'
          description: Identifier for the transaction, decided by the Payer FSP during the creation of the quote.
        to:
          $ref: '#/components/schemas/transferPartyInbound'
          description: Information about the Payee in the proposed financial transaction.
        from:
          $ref: '#/components/schemas/transferPartyInbound'
          description: Information about the Payer in the proposed financial transaction.
        amountType:
          $ref: '#/components/schemas/amountType'
          description: SEND for send amount, RECEIVE for receive amount.
        amount:
          $ref: '#/components/schemas/money'
          description: Depending on `amountType`. If SEND - The amount the Payer would like to send, that is, the amount that should be withdrawn from the Payer account including any fees. The amount is updated by each participating entity in the transaction. If RECEIVE - The amount the Payee should receive, that is, the amount that should be sent to the receiver exclusive any fees. The amount is not updated by any of the participating entities.
        currency:
          $ref: '#/components/schemas/currency'
        feesAmount:
          $ref: '#/components/schemas/money'
          description: The fees in the transaction. The fees element should be empty if fees should be non-disclosed. The fees element should be non-empty if fees should be disclosed.
        feesCurrency:
          $ref: '#/components/schemas/currency'
        transactionType:
          $ref: '#/components/schemas/transactionType'
          description: Type of transaction for which the quote is requested.
        initiator:
          $ref: '#/components/schemas/initiator'
          description: Specifies if the initiator of the transfer is the Payer or Payee.
        initiatorType:
          $ref: '#/components/schemas/initiatorType'
          description: Specifies the type of the transaction initiator.
        geoCode:
          $ref: '#/components/schemas/geoCode'
          description: Longitude and Latitude of the initiating party. Can be used to detect fraud.
        note:
          type: string
          minLength: 1
          maxLength: 128
          description: An optional note associated with the requested transfer.
        expiration:
          $ref: '#/components/schemas/timestamp'
          description: An optional deadline for responding to the quote request.

    quoteResponse:
      type: object
      description: A response to a request for a quote.
      required:
        - quoteId
        - transactionId
        - transferAmount
        - transferAmountCurrency
      properties:
        quoteId:
          $ref: '#/components/schemas/quoteId'
          description: ID of the quote that this response relates to.
        transactionId:
          $ref: '#/components/schemas/transactionId'
          description: Identifier for the transaction, decided by the Payer FSP during the creation of the quote.
        transferAmount:
          $ref: '#/components/schemas/money'
          description: The amount of money that the Payer FSP should transfer to the Payee FSP.
        transferAmountCurrency:
          $ref: '#/components/schemas/currency'
          description: The currency of the `transferAmount`.
        payeeReceiveAmount:
          $ref: '#/components/schemas/money'
          description: The amount that the Payee should receive in the end-to-end transaction. Optional as the Payee FSP might not want to disclose any optional Payee fees.
        payeeReceiveAmountCurrency:
          $ref: '#/components/schemas/currency'
          description: The currency of the `payeeReceiveAmount`.
        payeeFspFeeAmount:
          $ref: '#/components/schemas/money'
          description: Payee FSP’s part of the transaction fee.
        payeeFspFeeAmountCurrency:
          $ref: '#/components/schemas/currency'
          description: The currency of the `payeeFspFeeAmount`.
        payeeFspCommissionAmount:
          $ref: '#/components/schemas/money'
          description: Transaction commission from the Payee FSP.
        payeeFspCommissionAmountCurrency:
          $ref: '#/components/schemas/currency'
          description: Currency of the `payeeFspCommissionAmount`.
        expiration:
          $ref: '#/components/schemas/timestamp'
          description: Timestamp specifying the validity period of the quotation.
        geoCode:
          $ref: '#/components/schemas/geoCode'
          description: Longitude and Latitude of the Payee. Can be used to detect fraud.
        extensionList:
          $ref: '#/components/schemas/extensionList'
          description: Optional extension, specific to deployment.

    timestamp:
      type: string
      pattern: ^(?:[1-9]\d{3}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1\d|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[1-9]\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-02-29)T(?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d(?:(\.\d{3}))(?:Z|[+-][01]\d:[0-5]\d)$
      description: An ISO-8601 formatted timestamp.

    transactionId:
      pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      type: string
      description: ID of the transaction, the ID is decided by the Payer FSP during the creation of the quote.

    transactionType:
      type: string
      enum:
        - TRANSFER
      description: Type of transaction.

    transferContinuationAccept:
      type: object
      properties:
        acceptQuote:
          type: boolean
          enum:
            - true
            - false
        acceptParty:
          type: boolean
          enum:
            - true

    transferError:
      type: object
      description: This object represents a Mojaloop API error received at any time during the transfer process
      properties:
        httpStatusCode:
          type: integer
          description: The HTTP status code returned to the caller. This is the same as the actual HTTP status code returned with the response.
        mojaloopError:
          description: If a transfer process results in an error callback during the asynchronous Mojaloop API exchange, this property will contain the underlying Mojaloop API error object.
          $ref: '#/components/schemas/mojaloopError'

    transferFulfilment:
      type: object
      description: A Mojaloop API transfer fulfilment
      properties:
        fulfilment:
          $ref: '#/components/schemas/ilpFulfilment'
          description: >
            Fulfilment of the condition specified with the transaction.
            Mandatory if transfer has completed successfully.
        completedTimestamp:
          $ref: '#/components/schemas/timestamp'
          description: Time and date when the transaction was completed.
        transferState:
          $ref: '#/components/schemas/mojaloopTransferState'
          description: State of the transfer.
        extensionList:
          $ref: '#/components/schemas/extensionListComplex'
          description: 'Optional extension, specific to deployment.'
      required:
        - transferState

    transferId:
      pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      type: string
      description: A Mojaloop API transfer identifier (UUID).

    transferParty:
      type: object
      required:
        - idType
        - idValue
      properties:
        type:
          $ref: '#/components/schemas/payerType'
        idType:
          $ref: '#/components/schemas/idType'
        idValue:
          $ref: '#/components/schemas/idValue'
        displayName:
          type: string
          description: Display name of the sender, if known.
        firstName:
          type: string
          description: Party first name.
        middleName:
          type: string
          description: Party middle name.
        lastName:
          type: string
          description: Party last name.
        dateOfBirth:
          $ref: '#/components/schemas/dateOfBirth'
        merchantClassificationCode:
          type: string
          description: Up to 4 digits specifying the sender's merchant classification, if known and applicable.
        fspId:
          type: string
          description: FSP with which the party is associated.
        extensionList:
          $ref: '#/components/schemas/extensionList'

    transferPartyInbound:
      type: object
      required:
        - idType
        - idValue
      properties:
        type:
          $ref: '#/components/schemas/payerType'
        idType:
          $ref: '#/components/schemas/idType'
        idValue:
          type: string
          description: The identifier string used to identify the sender.
        fspId:
          type: string
          description: The identifier string used to identify the FSP.
        displayName:
          type: string
          description: Display name of the sender, if known.
        firstName:
          type: string
          description: Party first name.
        middleName:
          type: string
          description: Party middle name.
        lastName:
          type: string
          description: Party last name.
        dateOfBirth:
          $ref: '#/components/schemas/dateOfBirth'
        merchantClassificationCode:
          type: string
          description: Up to 4 digits specifying the sender's merchant classification, if known and applicable.
        extensionList:
          $ref: '#/components/schemas/extensionList'

    transferRequest:
      type: object
      required:
        - homeTransactionId
        - from
        - to
        - amountType
        - currency
        - amount
        - transactionType
      properties:
        homeTransactionId:
          type: string
          description: Transaction ID from the DFSP backend, used to reconcile transactions between the Switch and DFSP backend systems.
        from:
          $ref: '#/components/schemas/transferParty'
        to:
          $ref: '#/components/schemas/transferParty'
        amountType:
          $ref: '#/components/schemas/amountType'
        currency:
          $ref: '#/components/schemas/currency'
        amount:
          $ref: '#/components/schemas/money'
        transactionType:
          $ref: '#/components/schemas/transactionType'
        note:
          maxLength: 128
          type: string
        quoteRequestExtensions:
          $ref: '#/components/schemas/extensionList'
        transferRequestExtensions:
          $ref: '#/components/schemas/extensionList'

    internalQuoteResponse:
      type: object
      properties:
        quoteId:
          type: string

        transactionId:
          type: string

        transferAmount:
          type: string

        transferAmountCurrency:
          type: string

        payeeFspFeeAmount:
          type: string

        payeeFspFeeAmountCurrency:
          type: string

        payeeFspCommissionAmount:
          type: string

        payeeFspCommissionAmountCurrency:
          type: string

        expiration:
          type: string

    putTransferRequestInbound:
      type: object
      properties:
        transferId:
          type: string

        direction:
          type: string

        quoteRequest:
          type: object
          properties:
            headers:
              type: object
              properties:
                content-type:
                  type: string

                date:
                  type: string

                fspiop-source:
                  type: string

                fspiop-destination:
                  type: string

                authorization:
                  type: string

                accept:
                  type: string

                content-length:
                  type: integer

                host:
                  type: string

                connection:
                  type: string




            body:
              type: object
              properties:
                quoteId:
                  type: string

                transactionId:
                  type: string

                amountType:
                  type: string

                amount:
                  type: object
                  properties:
                    currency:
                      type: string

                    amount:
                      type: string




                expiration:
                  type: string

                payer:
                  type: object
                  properties:
                    partyIdInfo:
                      type: object
                      properties:
                        partyIdType:
                          type: string

                        partyIdentifier:
                          type: string

                        fspId:
                          type: string




                    name:
                      type: string




                payee:
                  type: object
                  properties:
                    partyIdInfo:
                      type: object
                      properties:
                        partyIdType:
                          type: string

                        partyIdentifier:
                          type: string

                        fspId:
                          type: string

                    personalInfo:
                      type: object
                      properties:
                        complexName:
                          type: object
                          properties:
                            firstName:
                              type: string

                            middleName:
                              type: string

                            lastName:
                              type: string

                        dateOfBirth:
                          type: string



                transactionType:
                  type: object
                  properties:
                    scenario:
                      type: string

                    initiator:
                      type: string

                    initiatorType:
                      type: string

                note:
                  type: string




        currentState:
          type: string

        initiatedTimestamp:
          type: string

        quote:
          type: object
          properties:
            request:
              type: object
              properties:
                quoteId:
                  type: string

                transactionId:
                  type: string

                amountType:
                  type: string

                amount:
                  type: object
                  properties:
                    currency:
                      type: string

                    amount:
                      type: string

                expiration:
                  type: string

                payer:
                  type: object
                  properties:
                    partyIdInfo:
                      type: object
                      properties:
                        partyIdType:
                          type: string

                        partyIdentifier:
                          type: string

                        fspId:
                          type: string

                    name:
                      type: string



                payee:
                  type: object
                  properties:
                    partyIdInfo:
                      type: object
                      properties:
                        partyIdType:
                          type: string

                        partyIdentifier:
                          type: string

                        fspId:
                          type: string

                    personalInfo:
                      type: object
                      properties:
                        complexName:
                          type: object
                          properties:
                            firstName:
                              type: string

                            middleName:
                              type: string

                            lastName:
                              type: string

                        dateOfBirth:
                          type: string




                transactionType:
                  type: object
                  properties:
                    scenario:
                      type: string

                    initiator:
                      type: string

                    initiatorType:
                      type: string

                note:
                  type: string

            internalRequest:
              type: object
              properties:
                quoteId:
                  type: string

                transactionId:
                  type: string

                to:
                  type: object
                  properties:
                    idType:
                      type: string

                    idValue:
                      type: string

                    fspId:
                      type: string

                    dateOfBirth:
                      type: string

                    firstName:
                      type: string

                    middleName:
                      type: string

                    lastName:
                      type: string

                from:
                  type: object
                  properties:
                    idType:
                      type: string

                    idValue:
                      type: string

                    fspId:
                      type: string

                    displayName:
                      type: string

                amountType:
                  type: string

                amount:
                  type: string

                currency:
                  type: string

                transactionType:
                  type: string

                initiator:
                  type: string

                initiatorType:
                  type: string

                note:
                  type: string

                expiration:
                  type: string

            response:
              $ref: '#/components/schemas/internalQuoteResponse'


            mojaloopResponse:
              type: object
              properties:
                transferAmount:
                  type: object
                  properties:
                    amount:
                      type: string

                    currency:
                      type: string

                expiration:
                  type: string

                ilpPacket:
                  type: string

                condition:
                  type: string

                payeeFspFee:
                  type: object
                  properties:
                    amount:
                      type: string

                    currency:
                      type: string

                payeeFspCommission:
                  type: object
                  properties:
                    amount:
                      type: string

                    currency:
                      type: string

            fulfilment:
              type: string

        quoteResponse:
          type: object
          properties:
            headers:
              type: object
              properties:
                content-type:
                  type: string

                date:
                  type: string

                fspiop-source:
                  type: string

                fspiop-destination:
                  type: string

                Authorization:
                  type: string

                content-length:
                  type: integer

            body:
              type: string

        prepare:
          type: object
          properties:
            body:
              type: object
              properties:
                transferId:
                  type: string

                payeeFsp:
                  type: string

                payerFsp:
                  type: string

                amount:
                  type: object
                  properties:
                    currency:
                      type: string

                    amount:
                      type: string

                ilpPacket:
                  type: string

                condition:
                  type: string

                expiration:
                  type: string

            headers:
              type: object
              properties:
                content-type:
                  type: string

                date:
                  type: string

                fspiop-source:
                  type: string

                fspiop-destination:
                  type: string

                authorization:
                  type: string

                accept:
                  type: string

                content-length:
                  type: integer

                host:
                  type: string

                connection:
                  type: string

        fulfil:
          type: object
          properties:
            headers:
              type: object
              properties:
                content-type:
                  type: string

                date:
                  type: string

                fspiop-source:
                  type: string

                fspiop-destination:
                  type: string

                Authorization:
                  type: string

                content-length:
                  type: integer

            body:
              type: string

        finalNotification:
          type: object
          properties:
            completedTimestamp:
              type: string

            transferState:
              type: string

    transferRequestInbound:
      type: object
      required:
        - transferId
        - quote
        - from
        - to
        - amountType
        - currency
        - amount
        - transactionType
      properties:
        transferId:
          $ref: '#/components/schemas/transferId'
        quote:
          $ref: '#/components/schemas/quoteResponse'
        from:
          $ref: '#/components/schemas/transferPartyInbound'
        to:
          $ref: '#/components/schemas/transferPartyInbound'
        amountType:
          $ref: '#/components/schemas/amountType'
        currency:
          $ref: '#/components/schemas/currency'
        amount:
          $ref: '#/components/schemas/money'
        transactionType:
          $ref: '#/components/schemas/transactionType'
        note:
          maxLength: 128
          type: string

    transferResponse:
      type: object
      required:
        - homeTransactionId
        - from
        - to
        - amountType
        - currency
        - amount
        - transactionType
      properties:
        transferId:
          $ref: '#/components/schemas/mojaloopIdentifier'
        homeTransactionId:
          type: string
          description: Transaction ID from the DFSP backend, used to reconcile transactions between the Switch and DFSP backend systems.
        from:
          $ref: '#/components/schemas/transferParty'
        to:
          $ref: '#/components/schemas/transferParty'
        amountType:
          $ref: '#/components/schemas/amountType'
        currency:
          $ref: '#/components/schemas/currency'
        amount:
          $ref: '#/components/schemas/money'
        transactionType:
          $ref: '#/components/schemas/transactionType'
        note:
          maxLength: 128
          type: string
        currentState:
          $ref: '#/components/schemas/transferStatus'
        quoteId:
          $ref: '#/components/schemas/mojaloopIdentifier'
        quoteResponse:
          $ref: '#/components/schemas/quote'
        quoteResponseSource:
          type: string
          description: >
            FSPID of the entity that supplied the quote response. This may not be the same as the FSPID of the entity which
            owns the end user account in the case of a foreign exchange (FOREX) transfer, i.e., it may be a FOREX gateway.
        fulfil:
          $ref: '#/components/schemas/transferFulfilment'
        lastError:
          description: >
            Object representing the last error to occur during a transfer process. This may be a Mojaloop API error returned from another entity in the scheme
            or an object representing other types of error e.g. exceptions that may occur inside the Mojaloop Connector.
          $ref: '#/components/schemas/transferError'

    transferState:
      type: string
      enum:
        - COMMITTED
        - ABORTED
      description: >
        Below are the allowed values for the enumeration
        - COMMITTED The transfer has been committed in the Switch. The Payee DFSP responds to the `COMMITTED` state with an HTTP 200 message, and then marks the transfer as completed. in its internal records.
        - ABORTED The transfer has been aborted in the Switch. The Payee DFSP responds to the `ABORTED` state with an HTTP 200 message, and then aborts the transfer in its internal records.

    transferResponseInbound:
      type: object
      required:
        - homeTransactionId
      properties:
        homeTransactionId:
          type: string
          description: Transaction ID from the DFSP backend, used to reconcile transactions between the Switch and DFSP backend systems.

    transferStatus:
      type: string
      enum:
        - ERROR_OCCURRED
        - WAITING_FOR_PARTY_ACCEPTANCE
        - WAITING_FOR_QUOTE_ACCEPTANCE
        - COMPLETED


  responses:
    '400':
      description: Malformed or missing required headers or parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/errorResponse'

    '404':
      description: The party specified by the provided identifier type and value is not known to the server

    '500':
      description: An error occurred processing the request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/errorResponse'

    transferSuccess:
      description: Transfer completed successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/transferResponse'

    transferBadRequest:
      description: Malformed or missing required body, headers or parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/errorTransferResponse'

    transferServerError:
      description: An error occurred processing the transfer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/errorTransferResponse'

    transferTimeout:
      description: Timeout occurred processing the transfer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/errorTransferResponse'

  parameters:
    idType:
      name: idType
      in: path
      required: true
      schema:
        type: string
        enum:
          - MSISDN
          - ACCOUNT_ID
      description: Below are the allowed values for the enumeration.

        - MSISDN -  An MSISDN (Mobile Station International Subscriber Directory Number, that is, the phone number) is used as reference to a participant. The MSISDN identifier should be in international format according to the [ITU-T E.164 standard](https://www.itu.int/rec/T-REC-E.164/en). Optionally, the MSISDN may be prefixed by a single plus sign, indicating the international prefix.

        - ACCOUNT_ID - A bank account number or FSP account ID should be used as reference to a participant. The ACCOUNT_ID identifier can be in any format, as formats can greatly differ depending on country and FSP.

    idValue:
      name: idValue
      in: path
      required: true
      schema:
        type: string
        minLength: 1
        maxLength: 128
      description: Identifier of the party.

    transferId:
      name: transferId
      in: path
      required: true
      schema:
        pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
        type: string
      description: Identifier of the transfer to continue as returned in the response to a `POST /sendmoney` request.
